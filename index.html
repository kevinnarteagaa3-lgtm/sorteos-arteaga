<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sorteos Arteaga ‚Äî Participa y gana</title>
<style>
  :root{
    --gold:#D4AF37;
    --red:#e53935;
    --gray:#4b4b4b;
    --black:#000;
    --muted:#9b9b9b;
    --white:#fff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--black);color:var(--white);font-family:Inter,system-ui,Arial,sans-serif}
  header{padding:18px 12px;text-align:center}
  .logo-wrap{display:flex;flex-direction:column;align-items:center;gap:6px}
  .logo-wrap img{width:120px;height:120px;object-fit:cover;border-radius:14px;border:3px solid var(--gold);background:#111}
  .site-title{font-size:22px;color:var(--gold);font-weight:800}
  .site-sub{font-size:13px;color:var(--muted)}
  main{max-width:1200px;margin:18px auto;padding:12px}
  .card{background:#0b0b0b;padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.05);margin-top:12px}
  .carousel-row{display:flex;gap:10px;overflow:auto;padding:6px}
  .carousel-row img{height:140px;border-radius:10px;object-fit:cover}
  .methods{background:#1a1a1a;color:var(--gold);padding:12px;border-radius:10px;font-weight:800;text-align:center}
  .promos{margin-top:8px;color:var(--gold);font-weight:800;text-align:center}

  .grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(70px,1fr));
    gap:10px;
    margin-top:14px;
    justify-items:center;
  }
  .num{
    width:100%;
    max-width:80px;
    aspect-ratio:1;
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius:10px;
    font-weight:800;
    font-size:15px;
    border:1px solid rgba(212,175,55,0.15);
    background:#111;
    color:var(--gold);
    cursor:pointer;
    transition:all .15s;
    box-shadow:0 0 10px rgba(0,0,0,0.3);
  }
  .num:hover{transform:scale(1.1);box-shadow:0 0 14px rgba(212,175,55,0.3)}
  .num.seleccionado{background:var(--gold);color:#000;box-shadow:0 0 18px rgba(212,175,55,0.5)}
  .num.vendido{background:var(--gray);color:#111;cursor:not-allowed;border-color:#333;opacity:0.7}
  .floating{position:fixed;right:18px;bottom:18px;z-index:999;display:none}
  .floating button{padding:16px 24px;font-size:16px;border-radius:14px;background:var(--red);color:#fff;border:none;font-weight:800;cursor:pointer}
  .seleccionTxt{margin-top:12px;color:var(--gold);font-weight:700;text-align:center}
  footer{margin-top:28px;padding:18px;text-align:center;color:var(--muted);font-size:13px}
  .modal-back{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:1000}
  .modal{width:92%;max-width:520px;background:#0c0c0c;padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}
  .modal h3{color:var(--gold);margin:0 0 10px 0;text-align:center}
  input,select,textarea{padding:10px;border-radius:8px;border:1px solid #222;background:#0a0a0a;color:#fff;width:100%;margin-top:8px}
  .row-flex{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:center;margin-top:10px}
  @media (max-width:900px){ .grid{grid-template-columns:repeat(auto-fill,minmax(55px,1fr))} }
</style>
</head>
<body>
<header>
  <div class="logo-wrap">
    <img id="logo" src="" alt="Logo Sorteos Arteaga">
    <div class="site-title">Sorteos Arteaga</div>
    <div class="site-sub">Participa y gana</div>
  </div>
</header>

<main>
  <div class="card" id="cardCarousel">
    <div id="carouselRow" class="carousel-row"></div>
  </div>

  <div class="card">
    <div id="descripcion" class="about">Cargando descripci√≥n...</div>
  </div>

  <div class="card">
    <div class="methods" id="methodsArea">M√©todos de pago: Transferencia y dep√≥sitos en OXXO</div>
    <div id="promos" class="promos"></div>
  </div>

  <div class="card" style="text-align:center">
    <h3 style="color:var(--gold);margin:0">üé∞ Maquinita de la Suerte</h3>
    <div class="row-flex">
      <select id="maqOpt" style="width:160px">
        <option value="1">1</option><option value="2">2</option><option value="3">3</option>
        <option value="4">4</option><option value="5">5</option><option value="10">10</option>
        <option value="15">15</option><option value="20">20</option><option value="50">50</option>
        <option value="100">100</option><option value="all">Todos</option>
      </select>
      <button id="btnGirar" style="background:var(--gold);color:#000;border:none;padding:10px 14px;border-radius:8px;font-weight:800;cursor:pointer">Girar</button>
      <button id="btnSelAll" style="background:#b71c1c;color:#fff;border:none;padding:10px 14px;border-radius:8px;font-weight:800;cursor:pointer">Seleccionar todos</button>
      <button id="btnLimpiar" style="background:#333;color:#fff;border:none;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer">Limpiar</button>
    </div>
    <div id="maqResult" class="seleccionTxt"></div>
  </div>

  <!-- üîπ Cuadro que mostrar√° los boletos generados por la maquinita -->
  <div class="modal-back" id="modalMaq">
    <div class="modal">
      <h3>üéüÔ∏è Boletos generados</h3>
      <div id="maqLista" style="color:var(--gold);text-align:center;font-weight:700"></div>
      <div style="display:flex;gap:8px;margin-top:14px;justify-content:center">
        <button id="maqApartar" style="background:var(--red);color:#fff;border:none;padding:12px;border-radius:10px;font-weight:800">Apartar boletos</button>
        <button id="maqCerrar" style="background:#333;color:#fff;border:none;padding:12px;border-radius:10px">Cerrar</button>
      </div>
    </div>
  </div>

  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div style="font-weight:800">Lista de boletos</div>
      <div style="color:var(--muted);font-size:13px">Los gris est√°n apartados ‚Äî los dorados disponibles</div>
    </div>
    <div id="counter" style="margin-top:8px;color:var(--gold);font-weight:700"></div>
    <div id="grid" class="grid"></div>
    <div id="selectionText" class="seleccionTxt"></div>
  </div>

  <div class="card">
    <div style="font-weight:800;color:var(--gold)">Preguntas frecuentes</div>
    <div class="faq" style="margin-top:8px;color:var(--muted)">
      <p><strong>¬øC√≥mo se elige a los ganadores?</strong> En base Loter√≠a Nacional de M√©xico ‚Äî transmisiones en vivo en Facebook e Instagram Sorteos Arteaga.</p>
      <p><strong>¬øPuedo participar de cualquier parte?</strong> S√≠, desde cualquier lugar de la Rep√∫blica Mexicana o extranjero.</p>
      <p><strong>¬øD√≥nde se publican los ganadores?</strong> En nuestras redes Sorteos Arteaga.</p>
      <p><strong>¬øQu√© pasa si el boleto ganador no est√° pagado?</strong> Se elige un nuevo ganador y se anuncia nueva fecha.</p>
    </div>
  </div>
</main>

<div class="modal-back" id="modalBack">
  <div class="modal">
    <h3>üì© Apartar boletos</h3>
    <label>N√∫meros seleccionados</label><input id="modalNums" readonly>
    <label>Nombre completo</label><input id="modalNombre" placeholder="Ej. Juan P√©rez">
    <label>Estado</label>
    <select id="modalEstado">
      <option value="">Selecciona estado</option>
      <option>Aguascalientes</option><option>Ciudad de M√©xico</option><option>Jalisco</option><option>Nuevo Le√≥n</option><option>Yucat√°n</option>
    </select>
    <label>Tel√©fono</label><input id="modalTelefono" placeholder="Ej. 521XXXXXXXXXX">
    <div style="display:flex;gap:8px;margin-top:10px">
      <button id="modalEnviar" style="background:var(--red);color:#fff;border:none;padding:12px;border-radius:10px;font-weight:800">Enviar y apartar</button>
      <button id="modalCerrar" style="background:#333;color:#fff;border:none;padding:12px;border-radius:10px">Cancelar</button>
    </div>
    <div id="modalMsg" style="margin-top:10px;color:var(--gold);font-weight:700"></div>
  </div>
</div>

<div class="floating" id="floatingBtn"><button id="btnFloating">üì© Apartar (0)</button></div>

<footer>
  ¬© 2025 Sorteos Arteaga ‚Äî Legalidad y transparencia (basados en Loter√≠a Nacional)<br>
  <small style="color:var(--muted)">¬øDudas? WhatsApp: <strong id="footerWa">5635088487</strong></small>
</footer>

<script>
const CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vTXgIMoW1LvdfzyJsFX75DuMWdoNctr7FAexHUz_TTgSgaXWLB5v-WiaZ2De7nYoVRoiQwbFCQi4pIv/pub?gid=0&single=true&output=csv";
let CONFIG={},vendidos=new Set(),seleccion=new Set();
const $=s=>document.querySelector(s),$$=s=>Array.from(document.querySelectorAll(s));

async function loadData(){
  try{
    const r=await fetch(CSV_URL);const text=await r.text();
    const [h,...rows]=text.trim().split("\n").map(r=>r.split(","));
    const map={};h.forEach((v,i)=>map[v.trim().toLowerCase()]=i);
    if(!rows.length)return;
    const c=rows[0];
    CONFIG.logo=c[map.logo]||"";CONFIG.descripcion=c[map.descripci√≥n]||"";CONFIG.whatsapp=c[map.whatsapp]||"";
    CONFIG.promociones=c[map.promociones]||"";CONFIG.emisiones=Number(c[map.emisiones]||0);
    CONFIG.imagenes=(c[map.fotos]||"").split(",").map(s=>s.trim()).filter(Boolean);
    vendidos=new Set((c[map.boletos_apartados]||"").split(",").map(s=>s.trim()));
    renderAll();
  }catch(e){$('#descripcion').textContent="‚ö†Ô∏è No se pudo cargar hoja CSV";}
}

function renderAll(){
  $('#logo').src=CONFIG.logo||"";
  $('#descripcion').textContent=CONFIG.descripcion||"Sin descripci√≥n";
  $('#footerWa').textContent=CONFIG.whatsapp||"";
  const car=$('#carouselRow');car.innerHTML="";
  (CONFIG.imagenes||[]).forEach(x=>{const i=document.createElement('img');i.src=x;car.appendChild(i);});
  $('#promos').textContent=CONFIG.promociones||"";
  const total=CONFIG.emisiones||0;$('#counter').textContent=`üéüÔ∏è ${total} boletos ‚Äî ${Math.max(0,total-vendidos.size)} disponibles`;
  const g=$('#grid');g.innerHTML="";
  for(let i=1;i<=total;i++){const n=i.toString().padStart(5,"0");const el=document.createElement('div');el.className='num';el.textContent=n;
    if(vendidos.has(n))el.classList.add('vendido');
    else el.onclick=()=>toggleSelect(el,n);
    g.appendChild(el);}
}

function toggleSelect(el,n){if(el.classList.contains('vendido'))return;
  el.classList.toggle('seleccionado');
  el.classList.contains('seleccionado')?seleccion.add(n):seleccion.delete(n);
  updateUI();}
function updateUI(){
  const arr=Array.from(seleccion).sort((a,b)=>a-b);
  $('#selectionText').textContent=arr.length?`Seleccionaste: ${arr.join(", ")}`:"";
  $('#floatingBtn').style.display=arr.length?'block':'none';
  $('#btnFloating').textContent=`üì© Apartar (${arr.length})`;
}
$('#btnFloating').onclick=()=>{$('#modalNums').value=Array.from(seleccion).join(", ");$('#modalBack').style.display='flex';}
$('#modalCerrar').onclick=()=>$('#modalBack').style.display='none';
$('#modalEnviar').onclick=()=>{
  const nombre=$('#modalNombre').value.trim(),estado=$('#modalEstado').value.trim(),tel=$('#modalTelefono').value.trim(),nums=$('#modalNums').value.trim();
  if(!nombre||!estado||!nums)return alert("Completa los datos");
  const waMsg=`Hola Sorteos Arteaga, quiero apartar: ${nums}.%0ANombre: ${nombre}%0AEstado: ${estado}%0ATel√©fono: ${tel}`;
  window.open(`https://wa.me/${CONFIG.whatsapp}?text=${waMsg}`,'_blank');
  seleccion.clear();$$('.num.seleccionado').forEach(n=>n.classList.remove('seleccionado'));updateUI();$('#modalBack').style.display='none';
};

// üîπ Ajuste: mostrar cuadro de boletos generados cuando se gira la maquinita
$('#btnGirar').onclick=()=>{
  const opt=$('#maqOpt').value;const avail=$$('.num:not(.vendido)').map(n=>n.textContent);
  let picks=[];if(opt==='all')picks=avail;
  else{const c=Math.min(Number(opt),avail.length);for(let i=0;i<c;i++){const idx=Math.floor(Math.random()*avail.length);picks.push(avail.splice(idx,1)[0]);}}
  seleccion=new Set(picks);
  $$('.num').forEach(n=>n.classList.toggle('seleccionado',seleccion.has(n.textContent)));
  updateUI();
  // Mostrar cuadro con boletos generados
  $('#maqLista').textContent=picks.join(", ");
  $('#modalMaq').style.display='flex';
};
$('#maqCerrar').onclick=()=>$('#modalMaq').style.display='none';
$('#maqApartar').onclick=()=>{
  $('#modalMaq').style.display='none';
  $('#modalNums').value=Array.from(seleccion).join(", ");
  $('#modalBack').style.display='flex';
};

$('#btnSelAll').onclick=()=>{seleccion=new Set($$('.num:not(.vendido)').map(n=>n.textContent));$$('.num').forEach(n=>n.classList.toggle('seleccionado',seleccion.has(n.textContent)));updateUI();}
$('#btnLimpiar').onclick=()=>{seleccion.clear();$$('.num.seleccionado').forEach(n=>n.classList.remove('seleccionado'));updateUI();}
loadData();
</script>
</body>
</html>
