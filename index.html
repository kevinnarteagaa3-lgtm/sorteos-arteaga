<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sorteos Arteaga</title>
<style>
  :root{--gold:#d4af37;--text:#222;--muted:#666}
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#fff;color:var(--text)}
  header{background:#faf5eb;border-bottom:4px solid var(--gold);text-align:center;padding:14px}
  header h1{color:var(--gold);margin:0}
  .container{max-width:1100px;margin:auto;padding:14px}
  .logo img{width:140px;border-radius:8px;display:block;margin:10px auto}
  .descripcion{background:#fff;padding:12px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.05);margin-bottom:14px}
  .carrusel{display:flex;gap:10px;overflow-x:auto;padding:10px}
  .carrusel img{height:140px;border-radius:8px}
  .boletos{display:grid;grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:8px;margin-top:12px}
  .boleto{padding:10px;background:#fff;border-radius:8px;text-align:center;font-weight:700;cursor:pointer}
  .vendido{background:#444;color:#bbb;cursor:not-allowed}
  .seleccionado{background:var(--gold);color:#000}
  input,select,button{padding:10px;border-radius:8px;border:1px solid #ddd;font-size:15px}
  button{background:var(--gold);color:#000;font-weight:700;border:none;cursor:pointer}
  footer{text-align:center;color:var(--muted);padding:16px;margin-top:20px}
  .form{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
  .maquinita{background:#fff;padding:12px;border-radius:8px;margin-top:16px;box-shadow:0 2px 6px rgba(0,0,0,0.05)}
</style>
</head>
<body>
<header><h1>Sorteos Arteaga</h1></header>
<div class="container">
  <div class="logo" id="logoWrap"></div>
  <div class="descripcion" id="descripcion">Cargando informaciÃ³n...</div>
  <div class="carrusel" id="carrusel"></div>

  <h3 style="color:#d4af37">Lista de boletos</h3>
  <div class="boletos" id="boletos"></div>

  <div class="form">
    <input id="nombre" placeholder="Tu nombre">
    <input id="telefono" placeholder="Tu nÃºmero (ej. 521...)">
    <select id="estado">
      <option value="">Selecciona tu estado</option>
      <option>Aguascalientes</option><option>Baja California</option><option>Baja California Sur</option>
      <option>Campeche</option><option>Chiapas</option><option>Chihuahua</option><option>Coahuila</option>
      <option>Colima</option><option>Durango</option><option>Estado de MÃ©xico</option><option>Guanajuato</option>
      <option>Guerrero</option><option>Hidalgo</option><option>Jalisco</option><option>MichoacÃ¡n</option>
      <option>Morelos</option><option>Nayarit</option><option>Nuevo LeÃ³n</option><option>Oaxaca</option>
      <option>Puebla</option><option>QuerÃ©taro</option><option>Quintana Roo</option><option>San Luis PotosÃ­</option>
      <option>Sinaloa</option><option>Sonora</option><option>Tabasco</option><option>Tamaulipas</option>
      <option>Tlaxcala</option><option>Veracruz</option><option>YucatÃ¡n</option><option>Zacatecas</option>
      <option>Ciudad de MÃ©xico</option>
    </select>
    <button id="btnApartar">ðŸ“² Apartar y enviar WhatsApp</button>
  </div>

  <div class="maquinita">
    <strong>ðŸŽ° Maquinita de la Suerte</strong>
    <div style="margin-top:8px;display:flex;gap:8px;align-items:center;flex-wrap:wrap">
      <label>Generar:</label>
      <input id="cantidadRandom" type="number" min="1" max="10000" value="1" style="width:90px">
      <button id="btnMaquinita">Girar</button>
    </div>
    <div id="resultado"></div>
  </div>

  <div style="margin-top:16px;color:#555">
    <b>Precio por boleto:</b> <span id="precio">-</span><br>
    <b>Promociones:</b> <span id="promos">-</span><br>
    <b>MÃ©todos de pago:</b> <span id="mp">-</span>
  </div>
</div>

<footer>ðŸ”’ Legalidad y transparencia: Basados en la LoterÃ­a Nacional â€” Â© Sorteos Arteaga</footer>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz5T9iWtXixpzHwwFSdNBa7rn1x6qA8gKd5Jock-GB6VV5DI0MCfOJbDSrGECPQWuF0lw/exec";
let config = {}, seleccionados = [];

async function cargar(){
  try{
    const r = await fetch(SCRIPT_URL);
    config = await r.json();
    document.getElementById('logoWrap').innerHTML = config.logo ? `<img src="${config.logo}">` : '';
    document.getElementById('descripcion').textContent = config.descripcion || '';
    document.getElementById('precio').textContent = config.precio || '-';
    document.getElementById('promos').textContent = config.promociones || '-';
    document.getElementById('mp').textContent = config.metodos_pago || '-';
    const fotos = (config.fotos||'').split(',').map(s=>s.trim()).filter(Boolean);
    const car = document.getElementById('carrusel'); car.innerHTML='';
    fotos.forEach(f=>{const img=document.createElement('img');img.src=f;car.appendChild(img);});
    renderBoletos();
  }catch(e){console.error(e);document.getElementById('descripcion').textContent="No se pudieron cargar los datos.";}
}

function renderBoletos(){
  const cont=document.getElementById('boletos');cont.innerHTML='';
  const total=Number(config.emisiones)||0;
  const vendidos=(config.boletos_vendidos||'').split(',').map(s=>Number(s.trim())).filter(Boolean);
  const vendidosSet=new Set(vendidos);
  for(let i=1;i<=total;i++){
    const b=document.createElement('div');
    b.className='boleto';b.textContent=i;
    if(vendidosSet.has(i)){b.classList.add('vendido');}
    else{b.onclick=()=>toggle(i,b);}
    cont.appendChild(b);
  }
}

function toggle(n,b){
  if(seleccionados.includes(n)){
    seleccionados=seleccionados.filter(x=>x!==n);
    b.classList.remove('seleccionado');
  }else{
    seleccionados.push(n);
    b.classList.add('seleccionado');
  }
}

document.getElementById('btnMaquinita').onclick=()=>{
  const n=Number(document.getElementById('cantidadRandom').value)||1;
  const total=Number(config.emisiones)||0;
  const vendidos=(config.boletos_vendidos||'').split(',').map(s=>Number(s.trim())).filter(Boolean);
  const libres=[];for(let i=1;i<=total;i++)if(!vendidos.includes(i))libres.push(i);
  const res=[];for(let i=0;i<n&&libres.length;i++){const idx=Math.floor(Math.random()*libres.length);res.push(libres.splice(idx,1)[0]);}
  res.forEach(x=>{const d=document.querySelectorAll('.boleto');d.forEach(bb=>{if(bb.textContent==x)bb.classList.add('seleccionado');});});
  seleccionados=[...new Set([...seleccionados,...res])];
  document.getElementById('resultado').textContent="NÃºmeros generados: "+res.join(', ');
};

document.getElementById('btnApartar').onclick=()=>{
  const nombre=document.getElementById('nombre').value.trim();
  const telefono=document.getElementById('telefono').value.trim();
  const estado=document.getElementById('estado').value.trim();
  if(!nombre||!telefono||!estado||!seleccionados.length){alert("Completa los datos y selecciona boletos.");return;}
  const msg=`Hola! Quiero apartar los boletos: ${seleccionados.join(', ')}%0ANombre: ${nombre}%0ATelÃ©fono: ${telefono}%0AEstado: ${estado}`;
  window.open(`https://wa.me/${config.whatsapp}?text=${msg}`,'_blank');
};
cargar();
</script>
</body>
</html>
