<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorteos Arteaga</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #000;
    color: #f1c40f;
    margin: 0;
    padding: 0;
    text-align: center;
  }
  header {
    padding: 20px;
  }
  #logo {
    max-width: 180px;
    margin-bottom: 15px;
    border-radius: 8px;
  }
  #carousel {
    display: flex;
    overflow: hidden;
    justify-content: center;
    align-items: center;
    height: 220px;
  }
  #carousel img {
    max-height: 200px;
    border-radius: 10px;
    display: none;
  }
  #carousel img.active {
    display: block;
  }
  #descripcion {
    margin: 20px auto;
    width: 90%;
    background: #1a1a1a;
    border-radius: 10px;
    padding: 15px;
  }
  #boletos {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin: 15px;
  }
  .boleto {
    width: 50px;
    height: 50px;
    margin: 5px;
    border-radius: 5px;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #fff;
    color: #000;
    font-weight: bold;
    cursor: pointer;
  }
  .vendido {
    background-color: #333;
    color: #888;
    cursor: not-allowed;
  }
  .seleccionado {
    background-color: #f1c40f;
    color: #000;
  }
  #apartado {
    margin-top: 20px;
  }
  input, select, button {
    padding: 10px;
    margin: 8px;
    border-radius: 5px;
    border: none;
    font-size: 15px;
  }
  button {
    background-color: #f1c40f;
    color: #000;
    cursor: pointer;
    font-weight: bold;
  }
  button:hover {
    background-color: #ffcc00;
  }
  footer {
    background-color: #111;
    padding: 20px;
    font-size: 14px;
  }
</style>
</head>
<body>
<header>
  <img id="logo" src="" alt="Logo Sorteos Arteaga">
  <h1>üéüÔ∏è Participa y gana con <b>Sorteos Arteaga</b></h1>
</header>

<div id="carousel"></div>

<div id="descripcion"></div>

<div id="boletos"></div>

<div id="apartado">
  <h3>üìã Apartar tus boletos</h3>
  <input type="text" id="nombre" placeholder="Tu nombre">
  <input type="text" id="telefono" placeholder="Tu n√∫mero de tel√©fono">
  <select id="estado">
    <option value="">Selecciona tu estado</option>
    <option>Aguascalientes</option><option>Baja California</option><option>Baja California Sur</option>
    <option>Campeche</option><option>Chiapas</option><option>Chihuahua</option><option>Ciudad de M√©xico</option>
    <option>Coahuila</option><option>Colima</option><option>Durango</option><option>Estado de M√©xico</option>
    <option>Guanajuato</option><option>Guerrero</option><option>Hidalgo</option><option>Jalisco</option>
    <option>Michoac√°n</option><option>Morelos</option><option>Nayarit</option><option>Nuevo Le√≥n</option>
    <option>Oaxaca</option><option>Puebla</option><option>Quer√©taro</option><option>Quintana Roo</option>
    <option>San Luis Potos√≠</option><option>Sinaloa</option><option>Sonora</option><option>Tabasco</option>
    <option>Tamaulipas</option><option>Tlaxcala</option><option>Veracruz</option><option>Yucat√°n</option>
    <option>Zacatecas</option>
  </select>
  <button onclick="enviarWhatsApp()">üì≤ Enviar apartado</button>
</div>

<footer>
  <p id="pagos"></p>
  <p id="redes"></p>
  <p>¬© 2025 Sorteos Arteaga - Todos los derechos reservados</p>
</footer>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycby-atfTTEvyN2LhhFnjlngvGOnfXYtqfIhEZbqWJjZ06Y9-MGmTDmzvqnYVLcDUK-bbIw/exec";

let datos = {};
let seleccionados = [];

async function cargarDatos() {
  try {
    const res = await fetch(scriptURL);
    datos = await res.json();

    document.getElementById("descripcion").innerText = datos.descripcion || "";
    document.getElementById("pagos").innerText = "üí≥ M√©todos de pago: " + (datos.metodosPago || "");
    document.getElementById("redes").innerText = "üåê Redes sociales: " + (datos.redes || "");

    if (datos.logo) document.getElementById("logo").src = datos.logo;

    // Carrusel
    const carruselDiv = document.getElementById("carousel");
    carruselDiv.innerHTML = "";
    if (datos.carrusel && datos.carrusel.length > 0) {
      datos.carrusel.forEach((img, i) => {
        const im = document.createElement("img");
        im.src = img;
        if (i === 0) im.classList.add("active");
        carruselDiv.appendChild(im);
      });
      let i = 0;
      setInterval(() => {
        const imgs = document.querySelectorAll("#carousel img");
        imgs.forEach(img => img.classList.remove("active"));
        imgs[i % imgs.length].classList.add("active");
        i++;
      }, 3000);
    }

    // Generar boletos
    generarBoletos(datos.emisiones || 0, datos.vendidos || "");
  } catch (e) {
    document.body.innerHTML = "<h2>Error al cargar los datos del sorteo.</h2>";
  }
}

function generarBoletos(total, vendidos) {
  const contenedor = document.getElementById("boletos");
  contenedor.innerHTML = "";
  const vendidosArr = vendidos.split(",").map(v => v.trim());
  for (let i = 1; i <= total; i++) {
    const btn = document.createElement("div");
    btn.classList.add("boleto");
    btn.textContent = i;
    if (vendidosArr.includes(i.toString())) {
      btn.classList.add("vendido");
    } else {
      btn.onclick = () => toggleSeleccion(i, btn);
    }
    contenedor.appendChild(btn);
  }
}

function toggleSeleccion(num, el) {
  if (seleccionados.includes(num)) {
    seleccionados = seleccionados.filter(n => n !== num);
    el.classList.remove("seleccionado");
  } else {
    seleccionados.push(num);
    el.classList.add("seleccionado");
  }
}

function enviarWhatsApp() {
  const nombre = document.getElementById("nombre").value;
  const telefono = document.getElementById("telefono").value;
  const estado = document.getElementById("estado").value;
  const boletos = seleccionados.join(", ");
  const numeroWhatsApp = datos.whatsapp || "525635088487";

  if (!nombre || !telefono || !estado || seleccionados.length === 0) {
    alert("Por favor completa todos los campos y selecciona boletos.");
    return;
  }

  const mensaje = `Hola! Soy ${nombre} del estado ${estado}. Quiero apartar los boletos: ${boletos}. Mi n√∫mero es ${telefono}.`;
  const url = `https://wa.me/${numeroWhatsApp}?text=${encodeURIComponent(mensaje)}`;
  window.open(url, "_blank");
}

cargarDatos();
</script>
</body>
</html>
