<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorteos Arteaga</title>
<style>
  :root {
    --fondo: #000;
    --dorado: #d4af37;
    --texto: #fff;
  }
  body {
    background: var(--fondo);
    color: var(--texto);
    font-family: "Poppins", sans-serif;
    margin: 0;
    padding: 0;
  }
  header {
    text-align: center;
    padding: 20px;
    border-bottom: 2px solid var(--dorado);
  }
  header img {
    max-width: 160px;
    border-radius: 10px;
  }
  h1 {
    color: var(--dorado);
    margin-top: 10px;
  }
  .descripcion {
    text-align: center;
    margin: 15px;
  }
  .boletos {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 8px;
    padding: 10px;
    max-width: 800px;
    margin: auto;
  }
  .boleto {
    background: #111;
    color: var(--texto);
    border: 2px solid var(--dorado);
    border-radius: 8px;
    text-align: center;
    padding: 8px 0;
    font-weight: 600;
    cursor: pointer;
    transition: 0.3s;
  }
  .boleto:hover {
    background: var(--dorado);
    color: #000;
  }
  .vendido {
    background: #333;
    color: #777;
    border-color: #444;
    cursor: not-allowed;
  }
  footer {
    text-align: center;
    padding: 15px;
    font-size: 14px;
    border-top: 1px solid #222;
  }
  .btn {
    background: var(--dorado);
    color: #000;
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
    margin-top: 10px;
  }
</style>
</head>
<body>
  <header>
    <img id="logo" src="" alt="Logo Sorteo">
    <h1>Sorteos Arteaga</h1>
  </header>

  <div class="descripcion" id="descripcion"></div>

  <div id="boletos" class="boletos"></div>

  <div style="text-align:center; margin:20px;">
    <button class="btn" onclick="maquinita()">ðŸŽ° Maquinita de la Suerte</button>
  </div>

  <footer>
    <div id="contacto"></div>
    <p>&copy; 2025 Sorteos Arteaga</p>
  </footer>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzRAHmLZbUkJVeN8_HIgFH5TklWg76T94pH14nQddwlgJmMDv5ud7OyWlvIxkH6wwYf4g/exec";

async function cargarDatos() {
  const r = await fetch(SCRIPT_URL);
  const data = await r.json();

  document.getElementById("logo").src = data.logo || "";
  document.getElementById("descripcion").textContent = data.descripcion || "";
  document.getElementById("contacto").innerHTML =
    `<p>ðŸ“± WhatsApp: <a href="https://wa.me/${data.whatsapp}" style="color:var(--dorado)">${data.whatsapp}</a></p>
     <p>ðŸ’³ MÃ©todos de pago: ${data.metodos_pago || ""}</p>`;

  generarBoletos(Number(data.emisiones), data.boletos_vendidos);
}

function generarBoletos(total, vendidos) {
  const cont = document.getElementById("boletos");
  cont.innerHTML = "";
  const lista = vendidos ? vendidos.split(",").map(v => v.trim()) : [];
  for (let i = 1; i <= total; i++) {
    const div = document.createElement("div");
    div.textContent = i;
    div.className = "boleto" + (lista.includes(i.toString()) ? " vendido" : "");
    if (!lista.includes(i.toString())) {
      div.onclick = () => apartar(i);
    }
    cont.appendChild(div);
  }
}

function apartar(num) {
  const nombre = prompt("Ingresa tu nombre completo para apartar el boleto #" + num);
  if (!nombre) return;
  const estado = prompt("Ingresa tu estado:");
  alert(`âœ… Boleto #${num} apartado por ${nombre} (${estado}).`);
}

function maquinita() {
  const total = document.querySelectorAll(".boleto:not(.vendido)").length;
  if (total === 0) return alert("No hay boletos disponibles.");
  const libres = [...document.querySelectorAll(".boleto:not(.vendido)")];
  const elegido = libres[Math.floor(Math.random() * libres.length)];
  elegido.scrollIntoView({behavior:"smooth",block:"center"});
  elegido.style.background = "var(--dorado)";
  elegido.style.color = "#000";
  alert("ðŸŽ° Tu nÃºmero de la suerte es: " + elegido.textContent);
}

cargarDatos();
</script>
</body>
</html>
