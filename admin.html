<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Panel Sorteos Arteaga</title>
<style>
  :root{
    --gold:#D4AF37;
    --red:#e53935;
    --gray:#333;
    --black:#000;
    --white:#fff;
  }
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--black);color:var(--white);padding:16px}
  h1{color:var(--gold);text-align:center;margin-bottom:20px}
  label{display:block;margin-top:14px;font-weight:600;color:var(--gold)}
  input,textarea{width:100%;padding:8px;border-radius:6px;border:1px solid #222;background:#111;color:#fff}
  textarea{min-height:80px}
  button{background:var(--red);color:#fff;border:none;padding:10px 18px;border-radius:8px;font-weight:700;cursor:pointer;margin-top:14px}
  button:hover{opacity:.9}
  .section{max-width:680px;margin:0 auto;margin-bottom:32px;background:#0b0b0b;padding:18px;border-radius:12px;border:1px solid #222}
  footer{text-align:center;margin-top:18px;color:#888;font-size:13px}
  .msg{color:var(--gold);font-weight:700;text-align:center;margin-top:8px}
</style>
</head>
<body>

<h1>ðŸ›  Panel Sorteos Arteaga</h1>

<div class="section">
  <label>URL pÃºblica CSV de tu hoja (output=csv)</label>
  <input id="csvUrl" placeholder="https://docs.google.com/spreadsheets/d/e/.../pub?output=csv">
  <button id="btnCargar">Cargar datos</button>
</div>

<div class="section" id="formArea" style="display:none">
  <label>Logo (URL)</label><input id="logo">
  <label>Fotos (separadas por coma)</label><input id="fotos">
  <label>DescripciÃ³n</label><textarea id="descripcion"></textarea>
  <label>WhatsApp (sin + ni espacios)</label><input id="whatsapp">
  <label>Precio</label><input id="precio">
  <label>Promociones</label><input id="promos">
  <label>MÃ©todos de pago (separados por |)</label><textarea id="metodos"></textarea>
  <label>Emisiones</label><input id="emisiones" type="number">
  <label>Boletos apartados (separados por coma)</label><textarea id="apartados"></textarea>

  <div style="text-align:center">
    <button id="btnGenerar">Generar filas para Sheets</button>
  </div>
  <div class="msg" id="msg"></div>
</div>

<div class="section" id="outputArea" style="display:none">
  <label>Bloque generado (para copiar a tu hoja en columnas Tipo | Campo | Valor)</label>
  <textarea id="output" readonly></textarea>
  <div class="msg">ðŸ“‹ Copia este bloque y pÃ©galo en tu hoja â€” luego publica como CSV.</div>
</div>

<footer>Â© 2025 Sorteos Arteaga â€” Panel administrativo</footer>

<script>
let datos={};
const $=s=>document.querySelector(s);

$('#btnCargar').onclick=async()=>{
  const url=$('#csvUrl').value.trim();
  if(!url)return alert("Pega la URL CSV pÃºblica de tu hoja");
  try{
    const res=await fetch(url); const text=await res.text();
    const [header,...rows]=text.trim().split("\n").map(r=>r.split(","));
    if(!rows.length)return alert("No se encontraron datos en la hoja");
    const map={}; header.forEach((h,i)=>map[h.trim().toLowerCase()]=i);
    const c=rows[0];
    datos={
      logo:c[map.logo]||"",
      fotos:c[map.fotos]||"",
      descripcion:c[map.descripciÃ³n]||"",
      whatsapp:c[map.whatsapp]||"",
      precio:c[map.precio]||"",
      promociones:c[map.promociones]||"",
      metodos_pago:c[map.metodos_pago]||"",
      emisiones:c[map.emisiones]||"",
      boletos_apartados:c[map.boletos_apartados]||""
    };
    Object.keys(datos).forEach(k=>{if($('#'+k))$('#'+k).value=datos[k];});
    $('#formArea').style.display='block';
    $('#msg').textContent="âœ… Datos cargados. Puedes editarlos.";
  }catch(e){alert("Error al leer la hoja. Revisa la URL.");}
};

$('#btnGenerar').onclick=()=>{
  const c=(id)=>$('#'+id).value.trim();
  const block=[
    `logo,fotos,descripciÃ³n,whatsapp,precio,promociones,metodos_pago,emisiones,boletos_apartados`,
    `${c('logo')},${c('fotos')},${c('descripcion')},${c('whatsapp')},${c('precio')},${c('promos')},${c('metodos')},${c('emisiones')},${c('apartados')}`
  ].join("\n");
  $('#output').value=block;
  $('#outputArea').style.display='block';
  $('#msg').textContent="âœ… Bloque generado, copia y pÃ©galo en tu hoja.";
};
</script>

</body>
</html>
