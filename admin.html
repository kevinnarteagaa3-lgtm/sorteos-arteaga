<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Panel Sorteos Arteaga</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#0b0b0b;color:#fff;margin:0;padding:20px}
  h1{color:#D4AF37;text-align:center}
  .card{background:#111;padding:16px;border-radius:10px;margin-bottom:16px;border:1px solid rgba(255,255,255,0.08)}
  label{display:block;margin-top:8px;font-weight:bold;color:#D4AF37}
  input,textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #333;background:#0a0a0a;color:#fff}
  textarea{min-height:60px}
  button{margin-top:12px;padding:12px 18px;border:none;border-radius:8px;background:#D4AF37;color:#000;font-weight:800;cursor:pointer}
  button:hover{background:#c9a531}
  .status{margin-top:10px;font-weight:700;text-align:center}
  .info{color:#999;font-size:13px;margin-top:4px}
</style>
</head>
<body>
<h1>‚öôÔ∏è Panel Sorteos Arteaga</h1>

<div class="card">
  <h3>Configuraci√≥n general</h3>
  <label>URL del logo</label>
  <input id="logo" placeholder="https://...">

  <label>Descripci√≥n</label>
  <textarea id="descripcion" placeholder="Texto de descripci√≥n del sorteo..."></textarea>

  <label>Im√°genes del carrusel (separadas por coma)</label>
  <textarea id="imagenes" placeholder="https://img1.jpg, https://img2.jpg"></textarea>

  <label>M√©todos de pago (cada uno separado con | )</label>
  <textarea id="metodos_pago" placeholder="BBVA 1234567890 | OXXO 9999999999"></textarea>

  <label>Promociones</label>
  <input id="promociones" placeholder="Ej. 2x1 en compras de 10 boletos">

  <label>WhatsApp de contacto</label>
  <input id="whatsapp" placeholder="Ej. 5635088487">

  <label>Total de boletos (emisiones)</label>
  <input id="emisiones" type="number" placeholder="Ej. 1000">

  <label>N√∫meros vendidos (separados por coma)</label>
  <textarea id="vendidos" placeholder="0001,0002,0003"></textarea>

  <div class="info">‚ö†Ô∏è Guarda y actualiza. La p√°gina p√∫blica se actualizar√° autom√°ticamente.</div>

  <button id="saveBtn">üíæ Guardar en hoja</button>
  <div id="status" class="status"></div>
</div>

<script>
const SHEET_POST_URL = "https://script.google.com/macros/s/AKfycbz3tEjemplo12345abcDEF/exec"; // üëâ reemplaza con tu URL de Apps Script
const SHEET_READ_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTXgIMoW1LvdfzyJsFX75DuMWdoNctr7FAexHUz_TTgSgaXWLB5v-WiaZ2De7nYoVRoiQwbFCQi4pIv/pub?gid=0&single=true&output=csv";

async function loadData(){
  try{
    const res = await fetch(SHEET_READ_URL);
    const text = await res.text();
    const rows = text.trim().split("\n").map(r=>r.split(","));
    const data = {};
    rows.forEach(c=>{
      if(c.length>=3 && c[0].toLowerCase().trim()==='config'){
        const campo = c[1].trim().toLowerCase();
        const valor = c.slice(2).join(",").trim();
        data[campo] = valor;
      }
    });
    // rellenar campos
    for(const k in data){ if(document.getElementById(k)) document.getElementById(k).value = data[k]; }
  }catch(err){
    document.getElementById("status").textContent = "‚ùå Error al leer la hoja.";
  }
}

document.getElementById("saveBtn").onclick = async ()=>{
  const payload = {
    action: "updateConfig",
    logo: logo.value,
    descripcion: descripcion.value,
    imagenes: imagenes.value,
    metodos_pago: metodos_pago.value,
    promociones: promociones.value,
    whatsapp: whatsapp.value,
    emisiones: emisiones.value,
    vendidos: vendidos.value
  };
  document.getElementById("status").textContent = "‚è≥ Guardando...";
  try{
    const res = await fetch(SHEET_POST_URL, {method:"POST",headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
    const t = await res.text();
    document.getElementById("status").textContent = "‚úÖ Guardado: " + t;
  }catch(err){
    console.error(err);
    document.getElementById("status").textContent = "‚ö†Ô∏è Error al guardar (revisa el Apps Script).";
  }
};

loadData();
</script>
</body>
</html>
