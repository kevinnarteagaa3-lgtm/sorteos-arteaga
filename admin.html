<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de Administraci√≥n - Sorteos Arteaga</title>
  <style>
    body {
      background-color: #111;
      color: #fff;
      font-family: Arial, sans-serif;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #00c3ff;
    }
    input, textarea {
      width: 90%;
      padding: 10px;
      margin: 8px;
      border-radius: 8px;
      border: none;
      font-size: 15px;
    }
    textarea { height: 80px; }
    label { display: block; margin-top: 15px; text-align: left; margin-left: 5%; }
    button {
      background-color: red;
      color: white;
      border: none;
      padding: 12px 25px;
      font-size: 16px;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 20px;
      font-weight: bold;
    }
    button:hover { background-color: #ff4444; }
    .box {
      background: #1b1b1b;
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      width: 90%;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    input[type="url"] {
      background-color: #222;
      color: #fff;
    }
  </style>
</head>
<body>

  <h1>üéØ Panel de Administraci√≥n - Sorteos Arteaga</h1>

  <div class="box">
    <h3>URL p√∫blica de la hoja CSV</h3>
    <input type="url" id="csvUrl" placeholder="Pega aqu√≠ el enlace p√∫blico CSV de tu hoja (output=csv)" value="https://docs.google.com/spreadsheets/d/e/2PACX-1vTXgIMoW1LvdfzyJsFX75DuMWdoNctr7FAexHUz_TTgSgaXWLB5v-WiaZ2De7nYoVRoiQwbFCQi4pIv/pub?gid=0&single=true&output=csv">
    <button onclick="cargarDatos()">Cargar datos</button>
  </div>

  <div class="box" id="panelEdicion" style="display:none;">
    <h3>Editar informaci√≥n del sorteo</h3>

    <label>Logo (URL de imagen):</label>
    <input type="text" id="logo">

    <label>Im√°genes adicionales (URL separadas por coma):</label>
    <input type="text" id="imagenes">

    <label>Descripci√≥n:</label>
    <textarea id="descripcion"></textarea>

    <label>WhatsApp:</label>
    <input type="text" id="whatsapp">

    <label>Precio:</label>
    <input type="text" id="precio">

    <label>Promociones:</label>
    <input type="text" id="promociones">

    <label>M√©todos de pago:</label>
    <input type="text" id="metodos_pago">

    <label>Emisiones totales:</label>
    <input type="text" id="emisiones">

    <label>Boletos apartados (separados por comas):</label>
    <input type="text" id="boletos_apartados">

    <button onclick="generarFilas()">Generar filas para Sheets</button>

    <h4>‚¨áÔ∏è Copia y pega esto en tu hoja de Google Sheets:</h4>
    <textarea id="output" readonly></textarea>
  </div>

  <script>
    async function cargarDatos() {
      const url = document.getElementById('csvUrl').value.trim();
      if (!url) return alert('Pega primero la URL p√∫blica del CSV');

      try {
        const response = await fetch(url);
        const text = await response.text();
        const filas = text.split('\n').map(r => r.split(','));
        const encabezados = filas[0].map(e => e.trim().toLowerCase());
        const valores = filas[1] || [];
        const info = {};
        encabezados.forEach((h, i) => info[h] = valores[i]?.trim() || '');

        document.getElementById('logo').value = info.logo || '';
        document.getElementById('imagenes').value = info.fotos || info.imagenes || '';
        document.getElementById('descripcion').value = info.descripcion || '';
        document.getElementById('whatsapp').value = info.whatsapp || '';
        document.getElementById('precio').value = info.precio || '';
        document.getElementById('promociones').value = info.promociones || '';
        document.getElementById('metodos_pago').value = info.metodos_pago || '';
        document.getElementById('emisiones').value = info.emisiones || '';
        document.getElementById('boletos_apartados').value = info.boletos_apartados || '';

        document.getElementById('panelEdicion').style.display = 'block';
      } catch (error) {
        alert('No se pudo cargar la hoja. Revisa que est√© publicada en formato CSV.');
      }
    }

    function generarFilas() {
      const campos = [
        'logo','imagenes','descripcion','whatsapp','precio','promociones','metodos_pago','emisiones','boletos_apartados'
      ];
      let texto = 'Logo,Imagenes,Descripcion,Whatsapp,Precio,Promociones,Metodos_pago,Emisiones,Boletos_apartados\n';
      const fila = campos.map(id => document.getElementById(id).value.replace(/\n/g, ' '));
      texto += fila.join(',') + '\n';
      document.getElementById('output').value = texto;

      alert('‚úÖ Copia el texto generado y p√©galo en tu hoja de Google Sheets.\nLuego publ√≠cala de nuevo como CSV.');
    }
  </script>
</body>
</html>
