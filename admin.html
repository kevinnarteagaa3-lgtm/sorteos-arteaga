<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel de Administraci√≥n - Sorteos Arteaga</title>
<style>
  body {
    background-color: #111;
    color: #ffcc00;
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 20px;
  }
  h1 { color: #ffcc00; }
  label { display: block; margin-top: 15px; font-weight: bold; }
  input, textarea, button, select {
    width: 90%;
    padding: 10px;
    margin-top: 5px;
    border-radius: 5px;
    border: none;
  }
  button {
    background-color: #ffcc00;
    color: #111;
    cursor: pointer;
    font-weight: bold;
  }
  button:hover { background-color: #ffaa00; }
  .preview {
    margin-top: 10px;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }
  .preview img {
    width: 100px;
    height: 100px;
    margin: 5px;
    border-radius: 10px;
    object-fit: cover;
  }
</style>
</head>
<body>

<h1>Panel de Administraci√≥n</h1>

<label>Logo del sitio:</label>
<input type="file" id="logoInput" accept="image/*">
<div class="preview" id="logoPreview"></div>

<label>Fotos de la p√°gina (carrusel):</label>
<input type="file" id="fotosInput" accept="image/*" multiple>
<div class="preview" id="fotosPreview"></div>

<label>Descripci√≥n:</label>
<textarea id="descripcion" rows="3"></textarea>

<label>N√∫mero de emisiones:</label>
<input type="number" id="emisiones" placeholder="Ejemplo: 100">

<label>M√©todos de pago:</label>
<textarea id="pagos" rows="2" placeholder="Ejemplo: Tarjeta, OXXO, Transferencia..."></textarea>

<label>N√∫meros de WhatsApp (hasta 3):</label>
<input type="text" id="whatsapp1" placeholder="+52 5635088487">
<input type="text" id="whatsapp2" placeholder="Opcional">
<input type="text" id="whatsapp3" placeholder="Opcional">

<label>Redes sociales:</label>
<input type="text" id="facebook" placeholder="Facebook">
<input type="text" id="instagram" placeholder="Instagram">
<input type="text" id="tiktok" placeholder="TikTok">

<label>Boletos vendidos (separa con comas):</label>
<textarea id="boletosVendidos" rows="3" placeholder="Ejemplo: 1,5,10,23..."></textarea>

<button onclick="guardarDatos()">üíæ Guardar Cambios</button>

<p id="mensaje"></p>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbxtK3de3r3txVgVCpQm4bmAjbt4wZXdmQ-RRv61hx24J0l4MIepyJo0pg6JjlOtKMsk/exec";

function previsualizar(input, previewId) {
  const preview = document.getElementById(previewId);
  preview.innerHTML = "";
  for (const file of input.files) {
    const reader = new FileReader();
    reader.onload = e => {
      const img = document.createElement("img");
      img.src = e.target.result;
      preview.appendChild(img);
    };
    reader.readAsDataURL(file);
  }
}

document.getElementById('logoInput').addEventListener('change', e => previsualizar(e.target, 'logoPreview'));
document.getElementById('fotosInput').addEventListener('change', e => previsualizar(e.target, 'fotosPreview'));

async function guardarDatos() {
  const logo = document.querySelector('#logoPreview img')?.src || "";
  const fotos = [...document.querySelectorAll('#fotosPreview img')].map(img => img.src);
  const descripcion = document.getElementById('descripcion').value;
  const emisiones = document.getElementById('emisiones').value;
  const pagos = document.getElementById('pagos').value;
  const whatsapp = [
    document.getElementById('whatsapp1').value,
    document.getElementById('whatsapp2').value,
    document.getElementById('whatsapp3').value
  ].filter(x => x);
  const redes = {
    facebook: document.getElementById('facebook').value,
    instagram: document.getElementById('instagram').value,
    tiktok: document.getElementById('tiktok').value
  };
  const boletosVendidos = document.getElementById('boletosVendidos').value.split(',').map(n => n.trim());

  const datos = {
    logo, fotos, descripcion, emisiones, pagos, whatsapp, redes, boletosVendidos
  };

  document.getElementById('mensaje').innerText = "Guardando...";
  
  try {
    const respuesta = await fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify(datos),
      headers: { "Content-Type": "application/json" }
    });
    const texto = await respuesta.text();
    document.getElementById('mensaje').innerText = "‚úÖ Datos guardados correctamente.";
  } catch (e) {
    document.getElementById('mensaje').innerText = "‚ùå No se pudo conectar con Sheets.";
  }
}
</script>

</body>
</html>
