<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin ‚Äî Sorteos Arteaga</title>
<style>
  body{background:#050505;color:#fff;font-family:Inter,Arial,sans-serif;margin:0;padding:18px}
  .wrap{max-width:980px;margin:18px auto}
  .card{background:#0b0b0b;padding:16px;border-radius:12px;border:2px solid rgba(212,175,55,0.12)}
  h1{color:#D4AF37;text-align:center;margin:6px 0 12px 0}
  label{display:block;margin-top:10px;color:#D4AF37;font-weight:700}
  input,textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid #222;background:#0d0d0d;color:#fff;margin-top:6px}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .col{flex:1;min-width:180px}
  button{background:#D4AF37;color:#000;padding:12px;border-radius:10px;border:none;font-weight:800;cursor:pointer;margin-top:12px}
  .small{color:#aaa;margin-top:8px;font-size:13px}
  .hint{color:#bbb;margin-top:6px;font-size:13px}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Panel de Administraci√≥n ‚Äî Sorteos Arteaga</h1>

      <label>Logo (URL p√∫blica)</label>
      <input id="logo" placeholder="https://...">

      <label>Fotos del carrusel (URLs separadas por comas)</label>
      <textarea id="fotos" placeholder="https://img1.jpg, https://img2.jpg"></textarea>

      <label>Descripci√≥n</label>
      <textarea id="descripcion" placeholder="Texto de la rifa, premios, c√≥mo se elige, etc."></textarea>

      <div class="row">
        <div class="col">
          <label>WhatsApp (sin +, ej. 5215635088487)</label>
          <input id="whatsapp">
        </div>
        <div class="col">
          <label>Precio por boleto (MXN)</label>
          <input id="precio" type="number">
        </div>
      </div>

      <label>Promociones</label>
      <input id="promociones" placeholder="Ej: 2 boletos por 100">

      <label>M√©todos de pago (cada m√©todo en nueva l√≠nea; por ejemplo: 'Transferencia: 0123456789') </label>
      <textarea id="metodos_pago" placeholder="Transferencia: BANCO XXXX 0123456789 (Nombre: ...)&#10;OXXO: 1234567890 (Referencia: ...)"></textarea>

      <div class="row">
        <div class="col">
          <label>N√∫mero total de emisiones (boletos)</label>
          <input id="emisiones" type="number" placeholder="Ej. 5000">
        </div>
        <div class="col">
          <label>Boletos vendidos/apartados (separados por coma)</label>
          <input id="boletos_vendidos" placeholder="Ej: 1,2,5,20">
        </div>
      </div>

      <button id="guardar">üíæ Guardar configuraci√≥n</button>
      <div id="status" class="small">Cargando...</div>
      <p class="hint">Si aparece "Error al guardar", revisa permisos en tu Apps Script (ejecutar como t√∫ y acceso P√∫blico). Puedes editar directamente en la hoja si lo prefieres.</p>
    </div>
  </div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzl8-sfJRysbmx8ohQbNbmG-1jt0zX15s5Foth6bordIO_JPkEVPks681EZBSEo_7hUtQ/exec";

async function cargar(){
  const status = document.getElementById('status'); status.textContent='Cargando...';
  try {
    const r = await fetch(SCRIPT_URL);
    const d = await r.json();
    document.getElementById('logo').value = d.logo || '';
    document.getElementById('fotos').value = d.fotos ? (Array.isArray(d.fotos)? d.fotos.join(', ') : d.fotos) : '';
    document.getElementById('descripcion').value = d.descripcion || '';
    document.getElementById('whatsapp').value = d.whatsapp || '';
    document.getElementById('precio').value = d.precio || '';
    document.getElementById('promociones').value = d.promociones || '';
    document.getElementById('metodos_pago').value = d.metodos_pago || '';
    document.getElementById('emisiones').value = d.emisiones || '';
    document.getElementById('boletos_vendidos').value = d.boletos_vendidos || '';
    status.textContent='‚úÖ Datos cargados';
  } catch (err) {
    console.error('cargar admin err',err);
    status.textContent='‚ö†Ô∏è No se pudo cargar (revisa URL/permisos)';
  }
}

document.getElementById('guardar').addEventListener('click', async ()=>{
  const status = document.getElementById('status'); status.textContent='Guardando...';
  const payload = {
    action: 'guardar',
    logo: document.getElementById('logo').value.trim(),
    fotos: document.getElementById('fotos').value.split(',').map(s=>s.trim()).filter(Boolean),
    descripcion: document.getElementById('descripcion').value.trim(),
    whatsapp: document.getElementById('whatsapp').value.trim(),
    precio: document.getElementById('precio').value,
    promociones: document.getElementById('promociones').value.trim(),
    metodos_pago: document.getElementById('metodos_pago').value.trim(),
    emisiones: Number(document.getElementById('emisiones').value) || 0,
    boletos_vendidos: document.getElementById('boletos_vendidos').value.trim()
  };

  try {
    const res = await fetch(SCRIPT_URL, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    const txt = await res.text();
    status.textContent = '‚úÖ Guardado correctamente';
    setTimeout(()=> cargar(),600);
  } catch (err) {
    console.error('guardar err',err);
    status.textContent = '‚ùå Error al guardar (revisa permisos o URL).';
  }
});

cargar();
</script>
</body>
</html>
